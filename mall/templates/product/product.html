{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Product</title>
    <style>
        .entry {
            width:300px;
            height:auto;
             float:left;
            display:inline;
        }
        .price {
            height: 25px;
            width: 55px;
            font-size: 17px;
            text-align: center;
        }
        .button{
            height: 25px;
            width: 75px;
            font-size: 17px;
            text-align: center;
        }
    </style>
</head>
<body>
<table id="table">
    {% for p in p_list %}
        <tr>
            <td><a href="{% url 'detail_link' pid=p.pid %}"><img id="image" src="{% static '' %}{{ p.thumbnail_image }}.jpg"></a></td>
            <td>product name: {{ p.pname }}</td>
            <td>product brand: {{ p.brand }}</td>
            <td>product price: {{ p.price }}</td>
        </tr>
    {% endfor %}
</table>
<div id="pagging"></div>



<form action="/Search/" method="post">
    {% csrf_token %}
    <div>
         <input name="find" id="search" value="CTS">
        <button>Search</button>
    </div>
</form>

<form action="/sort/" method="post">
    {% csrf_token %}
    <div class="sort">
        <h3>Sort</h3>
        <input type="text" class="price" name="fprice" value="0"> -- <input type="text" class="price" name="lprice" value="100"><br><br>
        <button name="sort" class="button">Submit</button>
    </div>
</form>

</body>
<script src="{% static 'jquery-3.4.1.min.js' %}"></script>
<script>
    pagging(1, 1);
    function pagging(pno, psize){
        var itable = document.getElementById("table");
        var num = itable.rows.length;

        //count how many pages
        var totalPage = countPage(num, psize);

        //start & end row
        var currentPage = pno;
        var startRow = (currentPage - 1) * psize + 1;
        var endRow = currentPage + psize;
        endRow = (num > endRow) ?endRow :num;

        //display & display
        for(var i=1; i < (num+1); i++){
            var irow = itable.rows[i - 1];
            if(i >= startRow && i < endRow || i === startRow && i === endRow){
                irow.style.display = "block";

            } else {
                irow.style.display = "none";
            }
        }

        var tempStr = "";
        if (currentPage > 1) {
            tempStr += "<a href=\"#\" onClick=\"pagging(" + (currentPage - 1) + "," + psize + ")\">Previous&nbsp;</a>"
            for (j = 1; j <= totalPage; j++) {
                tempStr += "<a href=\"#\" onClick=\"pagging(" + j + "," + psize + ")\">" + j + "&nbsp;</a>"
            }
        } else {
            tempStr += "Previous&nbsp;";
            for (j = 1; j <= totalPage; j++) {
                tempStr += "<a href=\"#\" onClick=\"pagging(" + j + "," + psize + ")\">" + j + "&nbsp;</a>"
            }
        }
        if (currentPage < totalPage) {
            tempStr += "<a href=\"#\" onClick=\"pagging(" + (currentPage + 1) + "," + psize + ")\">Next</a>";
            for (j = 1; j <= totalPage; j++) {
            }
        } else {
            tempStr += "Next";
            for (j = 1; j <= totalPage; j++) {
            }
        }
        document.getElementById("pagging").innerHTML = tempStr;
    }


    function countPage(num, pageSize){
        var totalPage = 0;
        if(num / pageSize > parseInt(num / pageSize)){
            totalPage = parseInt(num / pageSize) + 1;
        } else {
            totalPage = parseInt(num / pageSize);
        }
        return totalPage;
    }
</script>
</html>