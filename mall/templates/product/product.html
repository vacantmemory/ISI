{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Product</title>
    <style>
         .product {
             width:250px;
            height:auto;
             float:left;
            display:inline;
             text-align: center;
             font-size: 18px;
         }
         .product {
            position: relative;
            overflow: hidden;
            background: #F0EFEF;
             padding-top: 20px;
            border-radius: 0.4rem;
             margin-right: 20px;
        }
        p {
            margin: 8px;
            margin-bottom: 0;
        }
        a {
            text-decoration: none;
            color: black;
        }
        h2 + div {
            overflow: auto;
        }
        h2 {
            margin-bottom: 0;
        }
        #pagging {
            padding:10px;
            padding-left: 35px;
        }
        #search_c {
            padding-left: 35px;
        }
        #search_c select {
            width: auto;
            height: 28px;
            font-size: 15px;
        }
        #search_c button {
            width: auto;
            height: 28px;
            font-size: 14px;
        }
        .sort {
            padding-left: 35px;
            padding-top: 15px;
        }
        .sort button {
            width: 93px;
            height: 28px;
            font-size: 14px;
            text-align: center;
        }
        .return {
            padding-left: 35px;
            padding-top: 15px;
        }
        .return button {
            width: 93px;
            height: 28px;
            font-size: 14px;
            text-align: center;
        }
    </style>
</head>
<body>
<h2>Product</h2>
<div>
    <ul id="table">
        {% for p in p_list %}
            <li class="product">
                <a href="{% url 'detail_link' pid=p.pid %}">
                    <div class="card-item">
                        <img id="image" src="{% static '' %}{{ p.thumbnail_image }}.png" alt>
                    </div>
                    <p>{{ p.pname }}</p>
                    <p>{{ p.brand }}</p>
                    <p>{{ p.price }}$</p>
                </a>
            </li>
        {% endfor %}
    </ul>
</div>

<div>
    <div id="pagging"></div>
    {{ message }}


    <form action="/product/search_vendor/" method="post" id="search_v">
        {% csrf_token %}
        <div>
            <input name="find" id="search" value="bible">
            <button>Search</button>
        </div>
    </form>

    <form action="/product/search/" method="post">
        {% csrf_token %}
        <div id="search_c">
            <select name="brand">
                <option value="Education">Education</option>
                <option value="Fiction">Fiction</option>
                <option value="Reference">Reference</option>
                <option value="Biography">Biography</option>
            </select>
                <button>Submit</button>
        </div>
    </form>
    <div id="showReturn" style="display: none">{{ ss }}</div>
    <div class="return">
        <a href="/product/"><button id="show">Return</button></a>
    </div>

    <div>
        <form action="/product/ascending/" method="post">
            {% csrf_token %}
            <div class="sort">
                <button name="Ascending" value="aa">Ascending</button>
            </div>
        </form>

        <form action="/product/descending/" method="post">
            {% csrf_token %}
            <div class="sort">
                <button name="Descending" value="aa">Descending</button>
            </div>
        </form>
    </div>
</div>



</body>
<script src="{% static 'jquery-3.4.1.min.js' %}"></script>
<script>
    pagging(1, 4);
    show();
    function pagging(pno, psize){

        var itable = $("li");
        var num = itable.length;
        var size = psize;
        //count how many pages
        var totalPage = countPage(num, size);

        //start & end row
        var currentPage = pno;
        var startRow = (currentPage - 1) * size + 1;
        var endRow = currentPage + size;
        endRow = (num > endRow) ?endRow :num;

        //display & display
        for(var i=1; i < (num+1); i++){
            var irow = itable.eq([i - 1]);
            if(i >= startRow && i < endRow || i === startRow && i === endRow){
                irow.show();
            } else {
                irow.hide();
            }
        }

        var tempStr = "";
        if (currentPage > 1) {
            tempStr += "<a href=\"#\" onClick=\"pagging(" + (currentPage - 1) + "," + psize + ")\">" +
                "<img src=\"{% static '' %}previous.png\" alt>" + "&nbsp;</a>";
            for (j = 1; j <= totalPage; j++) {
                tempStr += "<a href=\"#\" onClick=\"pagging(" + j + "," + psize + ")\">" + "<img src=\"{% static '' %}"+ j +".png\" alt>" + "&nbsp;</a>"
            }
        } else {
            tempStr += "<img src=\"{% static '' %}previous.png\" alt>&nbsp;";
            for (j = 1; j <= totalPage; j++) {
                tempStr += "<a href=\"#\" onClick=\"pagging(" + j + "," + psize + ")\">" + "<img src=\"{% static '' %}"+ j +".png\" alt>" + "&nbsp;</a>"
            }
        }
        if (currentPage < totalPage) {
            tempStr += "<a href=\"#\" onClick=\"pagging(" + (currentPage + 1) + "," + psize + ")\">" +
                "<img src=\"{% static '' %}next.png\" alt>" + "</a>";
            for (j = 1; j <= totalPage; j++) {
            }
        } else {
            tempStr += "<img src=\"{% static '' %}next.png\" alt>";
            for (j = 1; j <= totalPage; j++) {
            }
        }
        document.getElementById("pagging").innerHTML = tempStr;
    }


    function countPage(num, pageSize){
        var totalPage = 0;
        if(num / pageSize > parseInt(num / pageSize)){
            totalPage = parseInt(num / pageSize) + 1;
        } else {
            totalPage = parseInt(num / pageSize);
        }
        return totalPage;
    }


    //search_c hide and show
    test();
    function test() {
        var a = {{ identity }};
        if(a === 0){
            $('#search_v').hide();
        }
        if(a === 1){
            $('#search_v').hide();
        }
        if(a === 2){
            $('#search_v').show();
        }
    }

    function show() {
        var data = $('#showReturn').html();
        if (data){
            $('#show').show();
        } else{
            $('#show').hide();
        }
    }
</script>
</html>