{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Product</title>
    <style>
         .product {
             width:250px;
            height:auto;
             float:left;
            display:inline;
         }
        #pagging {
            position: absolute;
            top: 380px;
        }
        #search_c {
            position: absolute;
            top: 400px;
        }
        #search_v {
            position: absolute;
            top: 410px;
        }
        #sort {
            position: absolute;
            top: 420px;
            left: 20px;
        }
    </style>
</head>

<ul id="table">
    {% for p in p_list %}
        <li class="product">
            <a href="{% url 'detail_link' pid=p.pid %}"><img id="image" src="{% static '' %}{{ p.thumbnail_image }}.jpg"></a>
            <p>product name: {{ p.pname }}</p>
            <p>product brand: {{ p.brand }}</p>
            <p>product price: {{ p.price }}</p>
        </li>
    {% endfor %}
</ul>

<div id="pagging"></div>
{{ message }}


<form action="/product/search_vendor/" method="post" id="search_v">
    {% csrf_token %}
    <div>
         <input name="find" id="search" value="bible">
        <button>Search</button>
    </div>
</form>

<form action="/product/search/" method="post" id="search_c">
    {% csrf_token %}
    <select name="brand">
        <option value="Education">Education</option>
        <option value="Fiction">Fiction</option>
        <option value="Reference">Reference</option>
    </select>
    <button>Submit</button>
</form>

<form action="/product/order/" method="post">
    {% csrf_token %}
    <button id="sort" name="Sort" value="aa">Sort</button>
</form>


</body>
<script src="{% static 'jquery-3.4.1.min.js' %}"></script>
<script>
    pagging(1, 2);
    function pagging(pno, psize){

        var itable = $("li");
        var num = itable.length;
        //count how many pages
        var totalPage = countPage(num, psize);

        //start & end row
        var currentPage = pno;
        var startRow = (currentPage - 1) * psize + 1;
        var endRow = currentPage + psize;
        endRow = (num > endRow) ?endRow :num;

        //display & display
        for(var i=1; i < (num+1); i++){
            var irow = itable.eq([i - 1]);
            if(i >= startRow && i < endRow || i === startRow && i === endRow){
                irow.show();

            } else {
                irow.hide();
            }
        }

        var tempStr = "";
        if (currentPage > 1) {
            tempStr += "<a href=\"#\" onClick=\"pagging(" + (currentPage - 1) + "," + psize + ")\">Previous&nbsp;</a>"
            for (j = 1; j <= totalPage; j++) {
                tempStr += "<a href=\"#\" onClick=\"pagging(" + j + "," + psize + ")\">" + j + "&nbsp;</a>"
            }
        } else {
            tempStr += "Previous&nbsp;";
            for (j = 1; j <= totalPage; j++) {
                tempStr += "<a href=\"#\" onClick=\"pagging(" + j + "," + psize + ")\">" + j + "&nbsp;</a>"
            }
        }
        if (currentPage < totalPage) {
            tempStr += "<a href=\"#\" onClick=\"pagging(" + (currentPage + 1) + "," + psize + ")\">Next</a>";
            for (j = 1; j <= totalPage; j++) {
            }
        } else {
            tempStr += "Next";
            for (j = 1; j <= totalPage; j++) {
            }
        }
        document.getElementById("pagging").innerHTML = tempStr;
    }


    function countPage(num, pageSize){
        var totalPage = 0;
        if(num / pageSize > parseInt(num / pageSize)){
            totalPage = parseInt(num / pageSize) + 1;
        } else {
            totalPage = parseInt(num / pageSize);
        }
        return totalPage;
    }


    //search_c hide and show
    test();
    function test() {
        var a = {{ identity }};
        if(a === 0){
            $('#search_v').hide();
        }
        if(a === 1){
            $('#search_v').hide();
        }
        if(a === 2){
            $('#search_v').show();
        }
    }
</script>
</html>