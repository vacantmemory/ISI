{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Product</title>
    <style>
        .product {
            color: #1F9A77 !important;
            text-decoration: underline;
        }
        h2 {
            margin-bottom: 20px;
        }
        .book {
             width:250px;
            height:auto;
             float:left;
            display:inline;
             text-align: center;
             font-size: 18px;
         }
        .book {
            position: relative;
            overflow: hidden;
            background: white;
             padding-top: 20px;
            border-radius: 0.4rem;
             margin-right: 20px;
             margin-top: 20px;
        }
        #image {
            margin-bottom: 10px;
        }
        a {
            text-decoration: none;
            color: black;
        }
        h2 {
            margin-left: 35px;
        }
        #pagging {
            padding-top: 20px;
            text-align: center;
        }
        .search {
            display: inline;
            float: left;
        }
        #search_c {
            padding-left: 35px;
        }
        #search_c select {
            width: auto;
            height: 34px;
            font-size: 14px;
        }
        #search_c button {
            background: #1F9A77;
            color: white;
            text-align: center;
        }
        #search_v {
            padding-left: 35px;
            padding-top: 62px;
        }
        #search_v input {
            width: auto;
            height: 34px;
            font-size: 15px;
        }
        #search_v button {
            text-align: center;
            background: #1F9A77;
            color: white;
         }
        .sort1, .sort2 {
            display: inline;
            float: right;
            padding-top: 62px;
        }
        .sort1 {
            margin-right: 40px;
        }
        .sort1 button, .sort2 button {
            text-align: center;
            background: #1F9A77;
            color: white;
            padding: 6px 12px 6px 12px;
            font-size: 14px;
            width: auto;
            height: 34px;
            border-style: solid;
            border-color: black;
        }
        #return {
            margin-left: 15px;
            margin-top: 62px;
        }
        #return button {
            text-align: center;
            background: #1F9A77;
            color: white;

        }
        .clear {
            clear: both;
        }

    </style>
     <link rel="stylesheet" type="text/css" href="{% static 'bootstrap.css' %}">
     <link rel="stylesheet" type="text/css" href="{% static 'style.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'font-awesome-4.7.0/css/font-awesome.min.css' %}">
</head>
<body id="body-style">
{% include 'Navbar.html' %}
<div class="main">
    <div class="container">
        <div class="search">
            <h2>Book</h2>
            <form action="/product/search/" method="post">
                {% csrf_token %}
                <div id="search_c">
                    <select name="brand">
                        <option value="Education">Education</option>
                        <option value="Fiction">Fiction</option>
                        <option value="Reference">Reference</option>
                        <option value="Biography">Biography</option>
                        <option value="Story">Story</option>
                    </select>
                    <button class="btn" type="submit">Filter by Brand</button>
                </div>
            </form>
            <div id="showReturn" style="display: none">{{ ss }}</div>
        </div>

         <div id="return" class="search">
                <a href="/product/"><button id="show" class="btn">List All</button></a>
        </div>

        <div class="search">
            <form action="/product/search_vendor/" method="post" id="search_v">
                {% csrf_token %}
                    <input name="find" id="search" value=""  placeholder="Search by id or name">
                    <button class="btn" type="submit">Search</button>
            </form>
        </div>

        <div>
            <form action="/product/ascending/" method="post" class="sort1">
                {% csrf_token %}
                <button name="Ascending" value="aa">Ascending</button>
            </form>
            <form action="/product/descending/" method="post" class="sort2">
                {% csrf_token %}
                <button name="Descending" value="aa">Descending</button>
            </form>
        </div>

        <div class="clear">
            <ul id="table">
                {% for p in p_list %}
                    <li class="book">
                        <a href="{% url 'detail_link' pid=p.pid %}">
                            <div class="card-item">
                                <img id="image" src="{% static '' %}{{ p.thumbnail_image }}.png" alt>
                            </div>
                            <p>{{ p.pname }}</p>
                            <p>{{ p.brand }}</p>
                            <p>{{ p.price }}$</p>
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </div>

        <div class="clear">
            <div id="pagging"></div>
            {{ message }}
        </div>

    </div>
</div>

{% include 'Footer.html' %}
</body>
<script src="{% static 'jquery-3.4.1.min.js' %}"></script>
<script>
    pagging(1, 4);
    show();
    function pagging(pno, psize){

        var itable = $(".book");
        var num = itable.length;
        var size = psize;
        //count how many pages
        var totalPage = countPage(num, size);

        //start & end row
        var currentPage = pno;
        var startRow = (currentPage - 1) * size + 1;
        var endRow = currentPage * size + 1;
        endRow = ((num+1)> endRow) ?endRow :num+1;

        //display & display
        for(var i=1; i < (num+1); i++){
            var irow = itable.eq([i - 1]);
            if((i >= startRow && i < endRow) || (i === startRow && i === endRow)){
                irow.show();
            } else {
                irow.hide();
            }
        }

        var tempStr = "";
        if (currentPage > 1) {
            tempStr += "<a href=\"#\" onClick=\"pagging(" + (currentPage - 1) + "," + psize + ")\">" +
                "<img src=\"{% static '' %}previous.png\" alt>" + "&nbsp;</a>";
            for (j = 1; j <= totalPage; j++) {
                tempStr += "<a href=\"#\" onClick=\"pagging(" + j + "," + psize + ")\">" + "<img src=\"{% static '' %}"+ j +".png\" alt>" + "&nbsp;</a>"
            }
        } else {
            tempStr += "<img src=\"{% static '' %}previous.png\" alt>&nbsp;";
            for (j = 1; j <= totalPage; j++) {
                tempStr += "<a href=\"#\" onClick=\"pagging(" + j + "," + psize + ")\">" + "<img src=\"{% static '' %}"+ j +".png\" alt>" + "&nbsp;</a>"
            }
        }
        if (currentPage < totalPage) {
            tempStr += "<a href=\"#\" onClick=\"pagging(" + (currentPage + 1) + "," + psize + ")\">" +
                "<img src=\"{% static '' %}next.png\" alt>" + "</a>";
            for (j = 1; j <= totalPage; j++) {
            }
        } else {
            tempStr += "<img src=\"{% static '' %}next.png\" alt>";
            for (j = 1; j <= totalPage; j++) {
            }
        }
        document.getElementById("pagging").innerHTML = tempStr;
    }


    function countPage(num, pageSize){
        var totalPage = 0;
        if(num / pageSize > parseInt(num / pageSize)){
            totalPage = parseInt(num / pageSize) + 1;
        } else {
            totalPage = parseInt(num / pageSize);
        }
        return totalPage;
    }


    //search_c hide and show
    test();
    function test() {
        var a = {{ identity }};
        if(a === 0){
            $('#search_v').hide();
        }
        if(a === 1){
            $('#search_v').hide();
        }
        if(a === 2){
            $('#search_v').show();
        }
    }

    function show() {
        var data = $('#showReturn').html();
        if (data){
            $('#show').show();
        } else{
            $('#show').hide();
        }
    }
</script>
</html>